== Git Style Guide

This is a Git Style Guide inspired by
https://kernel.org/doc/html/latest/process/submitting-patches.html[_How
to Get Your Change Into the Linux Kernel_], the
http://git-scm.com/doc[git man pages] and various practices popular
among the community.

Translations of the original link:https://github.com/agis/git-style-guide[document] are available in the following languages:

* https://github.com/aseaday/git-style-guide[Chinese (Simplified)]
* https://github.com/JuanitoFatas/git-style-guide[Chinese (Traditional)]
* https://github.com/pierreroth64/git-style-guide[French]
* https://github.com/runjak/git-style-guide[German]
* https://github.com/grigoria/git-style-guide[Greek]
* https://github.com/objectx/git-style-guide[Japanese]
* https://github.com/ikaruce/git-style-guide[Korean]
* https://github.com/guylhermetabosa/git-style-guide[Portuguese]
* https://github.com/alik0211/git-style-guide[Russian]
* https://github.com/jeko2000/git-style-guide[Spanish]
* https://github.com/zondezatera/git-style-guide[Thai]
* https://github.com/CnytSntrk/git-style-guide[Turkish]
* https://github.com/denysdovhan/git-style-guide[Ukrainian]

If you feel like contributing, please do so! Fork the project and open a
pull request.

== Table of contents

[arabic]
. link:#branches[Branches]
. link:#commits[Commits]
. link:#messages[Messages]
. link:#merging[Merging]
. link:#misc[Misc.]

=== Branches

* Choose _short_ and _descriptive_ names:
+
[source,shell]
----
# good
$ git checkout -b oauth-migration

# bad - too vague
$ git checkout -b login_fix
----
* Identifiers from corresponding tickets in an external service (eg. a
GitHub issue) are also good candidates for use in branch names. For
example:
+
[source,shell]
----
# GitHub issue #15
$ git checkout -b issue-15
----
* Use lowercase in branch names. External ticket identifiers with
uppercase letters are a valid exception. Use _hyphens_ to separate
words.
+
[source,shell]
----
$ git checkout -b new-feature      # good
$ git checkout -b T321-new-feature # good (Phabricator task id)
$ git checkout -b New_Feature      # bad
----
* When several people are working on the _same_ feature, it might be
convenient to have _personal_ feature branches and a _team-wide_ feature
branch. Use the following naming convention:
+
[source,shell]
----
$ git checkout -b feature-a/master # team-wide branch
$ git checkout -b feature-a/maria  # Maria's personal branch
$ git checkout -b feature-a/nick   # Nick's personal branch
----
+
Merge at will the personal branches to the team-wide branch (see
link:#merging[`Merging`]). Eventually, the team-wide branch will be
merged to `master`.
* Delete your branch from the upstream repository after it’s merged,
unless there is a specific reason not to.
+
[TIP]
====
Use the following command while being on `master`, to list merged
branches:
[source,shell]
----
$ git branch --merged | grep -v "\*"
----
====

=== Commits

* Each commit should be a single _logical change_. Don’t make several
_logical changes_ in one commit. For example, if a patch fixes a bug and
optimizes the performance of a feature, split it into two separate
commits.
+
TIP: Use `git add -p` to interactively stage specific portions of the
modified files.
* Don’t split a single _logical change_ into several commits. For
example, the implementation of a feature and the corresponding tests
should be in the same commit.
* Commit _early_ and _often_. Small, self-contained commits are easier
to understand and revert when something goes wrong.
* Commits should be ordered _logically_. For example, if _commit X_
depends on changes done in _commit Y_, then _commit Y_ should come
before _commit X_.

NOTE: While working alone on a local branch that _has not yet been
pushed_, it’s fine to use commits as temporary snapshots of your work.
However, it still holds true that you should apply all of the above
_before_ pushing it.

==== Messages

* Use the editor, not the terminal, when writing a commit message:
+
[source,shell]
----
# good
$ git commit

# bad
$ git commit -m "Quick fix"
----
+
Committing from the terminal encourages a mindset of having to fit
everything in a single line which usually results in non-informative,
ambiguous commit messages.
* The summary line (ie. the first line of the message) should be
_descriptive_ yet _succinct_. Ideally, it should be no longer than _50
characters_. It should be capitalized and written in imperative present
tense. It should not end with a period since it is effectively the
commit _title_:
+
[source,shell]
----
# good - imperative present tense, capitalized, fewer than 50 characters
Mark huge records as obsolete when clearing hinting faults

# bad
fixed ActiveModel::Errors deprecation messages failing when AR was used outside of Rails.
----
* After that should come a blank line followed by a more thorough
description. It should be wrapped to _72 characters_ and explain _why_
the change is needed, _how_ it addresses the issue and what
_side-effects_ it might have.
+
It should also provide any pointers to related resources (eg. link to
the corresponding issue in a bug tracker):
+
[source,text]
----
Short (50 chars or fewer) summary of changes

More detailed explanatory text, if necessary. Wrap it to
72 characters. In some contexts, the first
line is treated as the subject of an email and the rest of
the text as the body.  The blank line separating the
summary from the body is critical (unless you omit the body
entirely); tools like rebase can get confused if you run
the two together.

Further paragraphs come after blank lines.

- Bullet points are okay, too

- Use a hyphen or an asterisk for the bullet,
  followed by a single space, with blank lines in
  between

The pointers to your related resources can serve as a footer
for your commit message. Here is an example that is referencing
issues in a bug tracker:

Resolves: #56, #78
See also: #12, #34

Source http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html
----
+
Ultimately, when writing a commit message, think about what you would
need to know if you run across the commit in a year from now.
* If a _commit A_ depends on _commit B_, the dependency should be stated
in the message of _commit A_. Use the SHA1 when referring to commits.
+
Similarly, if _commit A_ solves a bug introduced by _commit B_, it
should also be stated in the message of _commit A_.
* If a commit is going to be squashed to another commit use the
`--squash` and `--fixup` flags respectively, in order to make the
intention clear:
+
[source,shell]
----
$ git commit --squash f387cab2
----
+
TIP: Use the `--autosquash` flag when rebasing. The marked commits
will be squashed automatically.

=== Merging

* *Do not rewrite published history.* The repository’s history is
valuable in its own right and it is very important to be able to tell
_what actually happened_. Altering published history is a common source
of problems for anyone working on the project.
* However, there are cases where rewriting history is legitimate. These
are when:
** You are the only one working on the branch and it is not being
reviewed.
** You want to tidy up your branch (eg. squash commits) and/or rebase it
onto the `master` in order to merge it later.
+
That said, _never rewrite the history of the `master` branch_ or any
other special branches (ie. used by production or CI servers).
* Keep the history _clean_ and _simple_. _Just before you merge_ your
branch:
[arabic]
. Make sure it conforms to the style guide and perform any needed
actions if it doesn’t (squash/reorder commits, reword messages etc.)
. Rebase it onto the branch it’s going to be merged to:
+
[source,shell]
----
[my-branch] $ git fetch
[my-branch] $ git rebase origin/master
# then merge
----
+
This results in a branch that can be applied directly to the end of the
`master` branch and results in a very simple history.
+
_(Note: This strategy is better suited for projects with short-running
branches. Otherwise it might be better to occassionally merge the
`master` branch instead of rebasing onto it.)_
* If your branch includes more than one commit, do not merge with a
fast-forward:
+
[source,shell]
----
# good - ensures that a merge commit is created
$ git merge --no-ff my-branch

# bad
$ git merge my-branch
----

=== Misc.

* There are various workflows and each one has its strengths and
weaknesses. Whether a workflow fits your case, depends on the team, the
project and your development procedures.
+
That said, it is important to actually _choose_ a workflow and stick
with it.
* _Be consistent._ This is related to the workflow but also expands to
things like commit messages, branch names and tags. Having a consistent
style throughout the repository makes it easy to understand what is
going on by looking at the log, a commit message etc.
* Do not mark your Pull Request as "ready for review" before you tested it. For that:
** open it as Draft
** or add `WIP` in its title
* Use
https://git-scm.com/book/en/v2/Git-Basics-Tagging#_annotated_tags[annotated
tags] for marking releases or other important points in the history.
Prefer
https://git-scm.com/book/en/v2/Git-Basics-Tagging#_lightweight_tags[lightweight
tags] for personal use, such as to bookmark commits for future
reference.
* Keep your repositories at a good shape by performing maintenance tasks
occasionally:
** http://git-scm.com/docs/git-gc[`git-gc(1)`]
** http://git-scm.com/docs/git-prune[`git-prune(1)`]
** http://git-scm.com/docs/git-fsck[`git-fsck(1)`]

== License

image:http://i.creativecommons.org/l/by/4.0/88x31.png[cc license]

This work is licensed under a
https://creativecommons.org/licenses/by/4.0/[Creative Commons
Attribution 4.0 International license].

== Credits

Agis Anastasopoulos / [@agisanast](https://twitter.com/agisanast) /
http://agis.io … and
https://github.com/agis-/git-style-guide/graphs/contributors[contributors]!
