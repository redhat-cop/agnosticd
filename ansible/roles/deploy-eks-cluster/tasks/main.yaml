---
- name: Create eks cluster
  when: ACTION == 'provision'
  block:
    - name: Create Open Environment resources
      ansible.builtin.include_role:
        name: create_resources.yaml

    - name: Generate kubeconfig
      when: deploy_eks_cluster_extract_kubeconfig | bool
      ansible.builtin.include_role:
        name: extract_kubeconfig.yml

    - name: Print information to user
      ansible.builtin.include_role:
        name: print_user_info.yaml

- name: Destroy Open Environment resources
  when: ACTION == 'destroy'
  ansible.builtin.include_role:
    name: destroy_resources.yaml
