---
- name: Copy user's contents
  when: rhel_zero_users_create_copy_user_contents is defined
  block:
    - name: Copy user's content to resource dir
      when: __content_r.resource is defined
      ansible.builtin.copy:
        content: "{{ __content_r.content }}"
        dest: >
          /home/{{ rhel_zero_users_create_name }}/
          {{ rhel_zero_users_create_resource_dir_name }}/
          {{ __content_r.resource }}
        owner: "{{ rhel_zero_users_create_name }}"
        group: "{{ rhel_zero_users_create_private_group }}"
      loop: "{{ rhel_zero_users_create_copy_user_contents }}"
      loop_control:
        loop_var: __content_r

    - name: Copy user's content to home dir
      when: __content_h.home is defined
      ansible.builtin.copy:
        content: "{{ __content_h.content }}"
        dest: "/home/{{ rhel_zero_users_create_name }}/{{ __content_h.home }}"
        owner: "{{ rhel_zero_users_create_name }}"
        group: "{{ rhel_zero_users_create_private_group }}"
      loop: "{{ rhel_zero_users_create_copy_user_contents }}"
      loop_control:
        loop_var: __content_h

    - name: Copy user's content to path
      when: __content_p.path is defined
      ansible.builtin.copy:
        content: "{{ __content_p.content }}"
        dest: "{{ __content_p.path }}"
        owner: "{{ rhel_zero_users_create_name }}"
        group: "{{ rhel_zero_users_create_private_group }}"
      loop: "{{ rhel_zero_users_create_copy_user_contents }}"
      loop_control:
        loop_var: __content_p
