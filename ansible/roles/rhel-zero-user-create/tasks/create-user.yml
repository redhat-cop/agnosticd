---

- name: Create user {{ rhel_zero_users_create_name }}
  ansible.builtin.user:
    name: "{{ rhel_zero_users_create_name }}"
    group: "{{ rhel_zero_users_create_private_group }}"
    append: "{{ rhel_zero_users_create_groups_append | default(true) }}"
    groups: "{{ rhel_zero_users_create_groups | default(omit) }}"
    update_password: "{{ rhel_zero_users_create_password_update | default(omit) }}"
    state: present

- name: Set ssh user {{ rhel_zero_users_create_name }} password
  when: rhel_zero_users_create_password is defined
  ansible.builtin.user:
    name: "{{ rhel_zero_users_create_name }}"
    password: "{{ rhel_zero_users_create_password | password_hash('sha512') | default(omit) }}"
    update_password: always
