---

- name: Subscription list 
  shell: hammer --output cve subscription list --organization "{{ORG}}"
  register: subscription_list
  tags:
    - satellite_configuration
    - manifest

- name: Copying and uploading Menifest
  when: subscription_list.stdout_lines.2.split(":").1.lstrip(' ') != SUBSCRIPTION_NAME     
  tags:
    - satellite_configuration
    - manifest
  block: 
    - name: Copy manifest
      copy:
        src: ./files/{{ MANIFEST_FILE }} 
        dest: /tmp

    - name: Uploading manifest 
      shell:  hammer subscription upload  
        --file /tmp/{{ MANIFEST_FILE }} 
        --organization "{{ORG}}"

