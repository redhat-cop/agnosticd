---
# DKafka
- name: Create Project for kafka
  shell: oc new-project kafka

- name: Create Cluster Operator Role
  shell: oc adm policy add-cluster-role-to-user strimzi-cluster-operator-namespaced --serviceaccount strimzi-cluster-operator -n kafka

- name: Create Entity Operator Role
  shell: oc adm policy add-cluster-role-to-user strimzi-entity-operator --serviceaccount strimzi-cluster-operator -n kafka

- name: Create Topic Operator Role
  shell: oc adm policy add-cluster-role-to-user strimzi-topic-operator --serviceaccount strimzi-cluster-operator -n kafka

- name: Install Cluster Operator
  shell: oc apply -f https://github.com/strimzi/strimzi-kafka-operator/releases/download/0.14.0/strimzi-cluster-operator-0.14.0.yaml -n kafka

- name: Create Kafka Cluster
  shell: oc apply -f https://raw.githubusercontent.com/roller1187/kafka-workshop/master/setup/my-cluster.yaml -n kafka

- name: Make Temp Directory
  file:
      path: /tmp/certs/
      state: directory

- name: Extract Secret
  shell: oc extract -n kafka secret/my-cluster-cluster-ca-cert --keys=ca.crt --to=- > /tmp/certs/ca.crt


# Directive Producer


- name: workload Tasks Complete
  debug:
    msg: workload Tasks Complete
