---
# Implement your Workload removal tasks here

- name: Remove Pipelines Installation
  k8s:
    state: absent
    definition: "{{ lookup('template', item ) | from_yaml }}"
  loop:
  - ./templates/pipelines.j2

- name: Remove OpenShift Pipelines operator
  k8s:
    state: absent
    definition: "{{ lookup('template', item ) | from_yaml }}"
  loop:
  - ./templates/subscription.j2
  - ./templates/catalog_source_config.j2

- name: Remove dashboard project
  k8s:
    name: tekton-pipelines
    api_version: v1
    kind: Namespace
    state: absent

# Leave this as the last task in the playbook.
- name: remove_workload tasks complete
  debug:
    msg: "Remove Workload tasks completed successfully."
  when: not silent|bool
