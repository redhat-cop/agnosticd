#vim: set ft=ansible:
---
- name: Get JBoss EAP 6.4
  get_url:
    url: https://drive.google.com/open?id=1FR93B99FU4kbEuE9OIQzYjhpnYP21DLq
    dest: /root/jboss-eap-6.4.0.zip
  register: r_geturl
  retries: 5
  delay: 20
  until: r_geturl is succeeded
  tags:
  - install_openshift_client_vm_packages

- name: Unarchive JBoss EAP 6.4 archive file
  unarchive:
    remote_src: yes
    src: /root/jboss-eap-6.4.0.zip
    dest: /root/
  tags:
  - install_openshift_client_vm_packages

- name: Move JBoss EAP 6.4 to /opt/eap
  copy:
    remote_src: yes
    src: /root/jboss-eap-6.4
    dest: /opt/eap
    group: users
    owner: lab-user
    mode: 0755
  tags:
  - install_openshift_client_vm_packages

- name: Cleanup Temp Directory
  file:
    dest: /root/jboss-eap-6.4
    state: absent
  tags:
  - install_openshift_client_vm_packages

- name: Cleanup downloaded file
  file:
    dest: /root/jboss-eap-6.4.0.zip
    state: absent
  tags:
  - install_openshift_client_vm_packages

- name: Get AMT
  get_url:
    url: https://drive.google.com/open?id=1Vh20d9UxngEzJGaHynfUFJqzf_vYRizK
    dest: /root/migrationtoolkit-rhamt-cli-4.1.0-offline.zip
  register: r_geturl
  retries: 5
  delay: 20
  until: r_geturl is succeeded
  tags:
  - install_openshift_client_vm_packages

- name: Unarchive AMT archive file
  unarchive:
    remote_src: yes
    src: /root/migrationtoolkit-rhamt-cli-4.1.0-offline.zip
    dest: /root/
  tags:
  - install_openshift_client_vm_packages

- name: Move AMT to /opt/rhamt
  copy:
    remote_src: yes
    src: /root/rhamt-cli-4.1.0.Final
    dest: /opt/rhamt
    group: users
    owner: lab-user
    mode: 0755
  tags:
  - install_openshift_client_vm_packages

- name: Cleanup Temp Directory
  file:
    dest: /root/rhamt-cli-4.1.0.Final
    state: absent
  tags:
  - install_openshift_client_vm_packages

- name: Cleanup downloaded file
  file:
    dest: /root/migrationtoolkit-rhamt-cli-4.1.0-offline.zip
    state: absent
  tags:
  - install_openshift_client_vm_packages

- name: add AMT to PATH
  lineinfile: dest=/home/lab-user/.bashrc line='export PATH=/opt/rhamt:$PATH' insertafter='EOF' state=present
  tags:
  - install_openshift_client_vm_packages
