---
# Implement your workload removal tasks here
# ------------------------------------------

- name: Remove the CNV workspace
  command: oc delete project workbook

- name: Remove additional L2 ports from VM's
  command: openstack port delete {{ item }}
  with_lines: openstack port list | awk '/port2/ {print $2;}'
  ignore_errors: yes

- name: Remove additional CNV ports
  command: openstack port delete {{ item }}
  with_lines: openstack port list | awk '/cnv-port/ {print $2;}'
  ignore_errors: yes

- name: Remove bastion-secgroup
  command: openstack security group delete bastion-secgroup

# Leave this as the last task in the playbook.
# --------------------------------------------

- name: remove_workload tasks complete
  debug:
    msg: "Remove Workload tasks completed successfully."
  when: not silent|bool
