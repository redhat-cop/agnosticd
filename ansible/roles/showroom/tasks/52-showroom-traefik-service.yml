---

- name: Setup showroom user socket playbook
  ansible.builtin.template:
    src: showroom-user-socket.yml.j2
    dest: "{{ showroom_user_orchestration_dir }}/showroom-user-socket.yml"
    owner: "{{ showroom_user }}"
    group: "{{ showroom_user_group }}"
    mode: "u=rw,g=r,o=r"

- name: Become block
  become: true
  block:
    - name: Setup very last service
      become: true
      ansible.builtin.template:
        src: showroom-socket-very-last.service.j2
        dest: "/etc/systemd/system/very-last.service"

    - name: Enable and Reload service
      ansible.builtin.systemd_service:
        name: very-last.service
        enabled: true
        daemon_reload: true
