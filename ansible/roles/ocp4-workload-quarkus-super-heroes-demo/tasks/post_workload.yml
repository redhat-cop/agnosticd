---
- name: Verify everything is deployed correctly
  include_tasks: verify_workload.yaml
  vars:
    t_project_name: "{{ ocp4_workload_quarkus_superheroes_proj_name }}-{{ item[1] }}java{{ item[0] }}"
    t_java_version: "{{ item[0] }}"
    t_app_kind: "{{ item[1] }}"
  loop: "{{ ocp4_workload_quarkus_superheroes_java_versions | product(ocp4_workload_quarkus_superheroes_kinds) | list }}"

- name: output demo info
  agnosticd_user_info:
    msg: |
      OpenShift credentials: {{ ocp_username }} / {{ ocp_password }}
      OpenShift/Kubernetes API (use with oc login): {{ master_url }}
      OpenShift Console URL: {{ console_url }}

      There are 4 projects, each correlating to a version of the application as defined in {{ ocp4_workload_quarkus_superheroes_link }}#versions:

  when: not silent|bool

- name: output project info
  vars:
    t_project_name: "{{ ocp4_workload_quarkus_superheroes_proj_name }}-{{ item[1] }}java{{ item[0] }}"
  agnosticd_user_info:
    msg: |
      - {{ t_project_name }} ({{ console_url }}/topology/ns/{{ t_project_name }})"
        - Super Heroes UI: http://ui-super-heroes-{{ t_project_name }}.{{ route_subdomain }}
        - Event statistics UI: http://event-statistics-{{ t_project_name }}.{{ route_subdomain }}
        - Heroes service data UI: http://rest-heroes-{{ t_project_name }}.{{ route_subdomain }}
        - Villains service data UI: http://rest-villains-{{ t_project_name }}.{{ route_subdomain }}
        - Apicurio Schema Registry: http://apicurio-{{ t_project_name }}.{{ route_subdomain }}
        - Prometheus: http://prometheus-operated-{{ t_project_name }}.{{ route_subdomain }}

  loop: "{{ ocp4_workload_quarkus_superheroes_java_versions | product(ocp4_workload_quarkus_superheroes_kinds) | list }}"
  when: not silent|bool

- name: post_workload tasks complete
  debug:
    msg: "Post-Workload Tasks completed successfully."
  when: not silent | bool
