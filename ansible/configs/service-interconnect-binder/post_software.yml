# vim: set ft=yaml.ansible
---
- name: Step 005 Post Software
  hosts: localhost
  connection: local
  become: false
  gather_facts: false
  tags:
  - step005
  - post_software
  tasks:
  - name: Entering the open-service-interconnect-binder post_software.yml
    debug:
      msg: Entering the open-service-interconnect-binder post_software.yml

# ---------------------------------------------------------------------------
# Setup Cluster Connections
# ---------------------------------------------------------------------------
  - name: Add rhel_a host to inventory
    ansible.builtin.add_host:
      name: "{{ rhel_a_provision_data.bastion_public_hostname }}"
      groups: rhel_bastion
      ansible_connection: ssh
      ansible_ssh_private_key_file: "~/.ssh/opentlc_admin_backdoor.pem"
      ansible_user: "ec2-user"
      remote_user: "ec2-user"

- name: Login to RHEL bastion
  hosts: rhel_bastion
  tasks:
  - name: Create directory for the the role
    file:
      path: ~/.kube/
      state: directory

  - name: Create file for the role
    file:
      path: ~/.kube/config
      state: touch

  - name: Include Service Interconnect role
    vars:
      ACTION: create
      service_interconnect_pods_install: true
    include_role:
      name: ocp4_workload_service_interconnect


- name: Step 005 Post Software
  hosts: localhost
  connection: local
  become: false
  gather_facts: false
  tags:
  - step005
  - post_software
  tasks:
  - name: Exiting the open-service-interconnect-binder post_software.yml
    debug:
      msg: Exiting the open-service-interconnect-binder post_software.yml
...
