- name: Install MySQL
  ansible.builtin.package:
    name: mariadb-server
    state: present

- name: Start and enable MySQL service
  ansible.builtin.service:
    name: mariadb
    state: started
    enabled: yes

- name: Ensure the 'demodata' database exists
  community.mysql.mysql_db:
    name: demodata
    state: present

- name: Add a table with random words and numbers
  community.mysql.mysql_query:
    login_db: demodata
    query: |
      GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '{{ hostvars.localhost.mysql_password }}' WITH GRANT OPTION;
       FLUSH PRIVILEGES;
      CREATE TABLE IF NOT EXISTS data (
        id INT AUTO_INCREMENT PRIMARY KEY,
        word VARCHAR(255) NOT NULL,
        number INT NOT NULL
      );
      INSERT INTO data (word, number) VALUES ('example', RAND() * 100);
