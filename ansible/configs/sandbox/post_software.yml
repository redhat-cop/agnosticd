---
- name: Step 00xxxxx post software
  hosts: localhost
  become: false
  gather_facts: false
  tasks:
  - debug:
      msg: "Post-Software Steps starting"

  - name: User info for IBM Cloud
    when: cloud_provider == 'ibm'
    block:
    - name: Print out email body for user
      agnosticd_user_info:
        body: "{{ item }}"
      loop:
      - "The information below can be used to access your IBM Cloud Sandbox environment."
      - ""
      - "You are only able to access the IBM Cloud using the CLI or APIs."
      - "UI access is not available at this time."
      - ""
      - "IBM Cloud API Key: {{ sandbox_sid_apikey }}"
      - "IBM Cloud Account ID: {{ sandbox_account_id }}"
      - "IBM Cloud Account Name: {{ sandbox_account_name }}"
      - ""
      - "To logon via the CLI:"
      - ""
      - "export IBMCLOUD_API_KEY={{ sandbox_sid_apikey }}"
      - "ibmcloud login"
      - ""
      - "Change your region (example):"
      - ""
      - "ibmcloud target -r us-south"
      - ""
      - "Visit the following pages to learn how to use the CLI and APIs."
      - ""
      - "IBM Cloud VPC API docs: https://cloud.ibm.com/apidocs/vpc"
      - "IBM Cloud CLI docs: https://cloud.ibm.com/docs/cli"
      - "IBM Cloud VPC SDKs: https://github.com/IBM?q=vpc&type=&language="
      - ""
      - "****************************WARNING**WARNING**WARNING****************************"
      - "** We monitor usage and we will be charging back to your cost center.          **"
      - "** Reports from the cloud provider of misuse or account compromise will result **"
      - "** in immediate deletion of this entire account without any warning to you.    **"
      - "** Do not post your credentials in GitHub/email/web pages/etc.                 **"
      - "**                                                                             **"
      - "** NOTE: Most account compromises occur by checking credentials into GitHub.   **"
      - "****************************WARNING**WARNING**WARNING****************************"
  
  - name: User info for AWS
    when: cloud_provider == 'ec2'
    block:
    - name: Print connectivity info and credential location to user.info
      agnosticd_user_info:
        msg: "{{ item }}"
      loop:
        - ""
        - "SSH Access: ssh {{ student_name }}@clientvm.{{ guid }}{{ subdomain_base_suffix }}"
        - "SSH password: {{ student_password | default(hostvars[groups.bastions.0].student_password) }}"
        - ""
        - "To become root you can use 'sudo -i'"
        - ""
        - "Your AWS credentials are:"
        - ""
        - "AWS_ACCESS_KEY_ID: {{ hostvars.localhost.student_access_key_id }}"
        - "AWS_SECRET_ACCESS_KEY: {{ hostvars.localhost.student_secret_access_key }}"
        - ""
        - "You can also find your aWS credentials on the clientvm host in /home/{{ student_name }}/.aws/credentials"
        - "The AWS CLI client is pre-installed and configured on the clientvm host."
        - ""
        - "Top level route53 domain: {{ subdomain_base_suffix }}"
        - "The default region is set to {{ aws_region }}"
        - ""
        - "Visit the following pages to learn how to use the CLI and APIs:"
        - ""
        - "AWS CLI Installation: https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html"
        - "AWS Config Basics: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html
        - "AWS API Getting Started: https://aws.amazon.com/developers/getting-started/"
        - ""
        - "****************************WARNING**WARNING**WARNING****************************"
        - "** We monitor usage and we will be charging back to your cost center.          **"
        - "** Reports from the cloud provider of misuse or account compromise will result **"
        - "** in immediate deletion of this entire account without any warning to you.    **"
        - "** Do not post your credentials in github/email/web pages/etc.                 **"
        - "** NOTE: Most account compromises occur by checking credentials into github.   **"
        - "****************************WARNING**WARNING**WARNING****************************"
