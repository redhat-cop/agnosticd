---
- name: Step 005 Post Software
  hosts: bastions
  become: true
  gather_facts: false
  tasks:
  - name: debug post-software starting
    ansible.builtin.debug:
      msg: "Post-Software Steps starting"

- name: install infra_workloads
  hosts: localhost
  gather_facts: false
  run_once: true
  become: false
  environment:
    K8S_AUTH_VERIFY_SSL: false
  tasks:
  - name: install infra_workloads
    when: infra_workloads | default("") | length > 0
    ansible.builtin.include_tasks: workloads.yml

- name: PostSoftware flight-check
  hosts: localhost
  connection: local
  gather_facts: false
  become: false
  tags:
  - post_flight_check
  tasks:
  - name: debug post-software completed
    ansible.builtin.debug:
      msg: "Post-Software checks completed successfully"
