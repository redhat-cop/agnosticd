- name: HTTP Status Code Testing
  hosts: localhost
  connection: local
  gather_facts: false
  become: false
  tasks:
    - name: Keep checking every minute until cluster is deleted
      uri:
        url: "https://httpstat.us/201?sleep=50"
        method: GET
        status_code: 200
      register: r_result
      until: r_result.elapsed == 200
      retries: 30
      delay: 1
    - debug:
        var: r_result
