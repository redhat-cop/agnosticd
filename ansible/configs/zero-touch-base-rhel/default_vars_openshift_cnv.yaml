---
# The type of cloud provider this will be deployed to
cloud_provider: openshift_cnv

# This is the user that Ansible will use to connect to the nodes it is
# configuring from the admin/control host
ansible_user: cloud-user
remote_user: cloud-user

### Networking and DNS (CNV)
subdomain_base_short: "{{ guid }}"
subdomain_base_suffix: ".{{ sandbox_openshift_apps_domain }}"
subdomain_base: "{{ subdomain_base_short }}{{ subdomain_base_suffix }}"


openshift_cnv_namespace: "{{ sandbox_openshift_namespace | default(env_type + '-' + guid) }}"

egress_dns_rule:
  - ports:
      - protocol: UDP
        port: 5353
      - protocol: TCP
        port: 5353
    to:
      - namespaceSelector:
          matchLabels:
            kubernetes.io/metadata.name: openshift-dns

#
# Network Configuration (lock_bastion_security_group_opebshift_cnv.yml)
#
# Default Ingress Rules (used if network_policy_ingress is not provided)
default_ingress_rules:
  - from:
      - ipBlock:
          cidr: "0.0.0.0/0"
          except: []
    ports:
      - protocol: TCP
        port: 443

# network_policy_ingress:
#  - from:
#     - ipBlock:
#       cidr: "0.0.0.0/0"
#       except: []
#   ports:
#     - protocol: TCP
#       port: 443
#     - protocol: TCP
#       port: 80

# Default Egress Rules (used if network_policy_egress is not provided)
default_egress_rules: []

# network_policy_egress:
#   - to:
#       - ipBlock:
#           cidr: "0.0.0.0/0"
#           except: []
#     ports:
#       - protocol: TCP
#         port: 53

#
# Instances to deploy
#
# Bastion Defaults
bastion_default_image: rhel-9.5
bastion_default_memory: 8G
bastion_default_cores: 1
bastion_default_image_size: 40
bastion_default_service:
  - name: bastion
    ports:
      - port: 443
        protocol: TCP
        targetPort: 443
        name: bastion-https

bastion_default_routes:
  - name: bastion-https
    host: bastion
    service: bastion
    targetPort: 443
    tls: true


instances:
  - name: "{{ bastion_hostname | default('bastion') }}"
    count: 1
    unique: true
    public_dns: false
    dns_loadbalancer: true
    floating_ip: false
    image: "{{ bastion_instance_image | default(bastion_default_image) }}"
    memory: "{{ bastion_instance_memory | default(bastion_default_memory) }}"
    cores: "{{ bastion_instance_cores | default(bastion_default_cores) }}"
    image_size: "{{ bastion_instance_image_size | default(bastion_default_image_size) }}"
    tags:
      - key: "AnsibleGroup"
        value: "bastions,showroom"
      - key: "ostype"
        value: "linux"
    networks:
      - default
    services: "{{ bastion_instance_service | default(bastion_default_service) }}"
    routes: "{{ bastion_instance_routes | default(bastion_default_routes) }}"
...
