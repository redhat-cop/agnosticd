---
- name: Downloading Manifest from OpenTLC
  get_url:
    url: "{{ satellite_manifest_url }}"
    dest: "/root/{{ satellite_manifest_url | regex_search('(\\w+)(\\.\\w+)+(?!.*(\\w+)(\\.\\w+)+)') }}"
    username: "{{ satellite_manifest.username | d(omit) }}"
    password: "{{ satellite_manifest.password | d(omit) }}"

- name: Inject Ansible Tower license manifest
  awx.awx.tower_license:
    manifest: "/root/{{ satellite_manifest_url | regex_search('(\\w+)(\\.\\w+)+(?!.*(\\w+)(\\.\\w+)+)') }}"
    eula_accepted: true
    tower_config_file: "/root/.tower_cli.cfg"
