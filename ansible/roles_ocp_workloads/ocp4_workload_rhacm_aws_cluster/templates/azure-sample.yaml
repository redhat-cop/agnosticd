apiVersion: hive.openshift.io/v1
kind: ClusterDeployment
metadata:
  name: 'judd-demo-1'
  namespace: 'judd-demo-1'
  labels:
    cloud: 'Azure'
    region: 'centralus'
    vendor: OpenShift
    cluster.open-cluster-management.io/clusterset: 'default'
spec:
  baseDomain: c8nrc.azure.redhatworkshops.io
  clusterName: 'judd-demo-1'
  controlPlaneConfig:
    servingCertificates: {}
  installAttemptsLimit: 1
  installed: false
  platform:
    azure:
      baseDomainResourceGroupName: openenv-c8nrc
      credentialsSecretRef:
        name: judd-demo-1-azure-creds
      region: centralus
      cloudName: AzurePublicCloud
  provisioning:
    installConfigSecretRef:
      name: judd-demo-1-install-config
    sshPrivateKeySecretRef:
      name: judd-demo-1-ssh-private-key
    imageSetRef:
       #quay.io/openshift-release-dev/ocp-release:4.9.41-x86_64
      name: img4.9.41-x86-64-appsub
  pullSecretRef:
    name: judd-demo-1-pull-secret
---
apiVersion: cluster.open-cluster-management.io/v1
kind: ManagedCluster
metadata:
  labels:
    cloud: Azure
    region: centralus
    name: 'judd-demo-1'
    vendor: OpenShift
    cluster.open-cluster-management.io/clusterset: 'default'
  name: 'judd-demo-1'
spec:
  hubAcceptsClient: true
---
apiVersion: hive.openshift.io/v1
kind: MachinePool
metadata:
  name: judd-demo-1-worker
  namespace: 'judd-demo-1'
spec:
  clusterDeploymentRef:
    name: 'judd-demo-1'
  name: worker
  platform:
    azure:
      osDisk:
        diskSizeGB: 128
      type: Standard_D2s_v3
      zones:
      - "1"
      - "2"
      - "3"
  replicas: 3
---
apiVersion: v1
kind: Secret
metadata:
  name: judd-demo-1-install-config
  namespace: 'judd-demo-1'
type: Opaque
data:
  # Base64 encoding of install-config yaml
  install-config.yaml: apiVersion: v1
metadata:
  name: 'judd-demo-1'
baseDomain: c8nrc.azure.redhatworkshops.io
controlPlane:
  architecture: amd64
  hyperthreading: Enabled
  name: master
  replicas: 3
  platform:
    azure:
      osDisk:
        diskSizeGB: 128
      type:  Standard_D4s_v3
compute:
- hyperthreading: Enabled
  architecture: amd64
  name: 'worker'
  replicas: 3
  platform:
    azure:
      type:  Standard_D2s_v3
      osDisk:
        diskSizeGB: 128
      zones:
      - "1"
      - "2"
      - "3"
networking:
  networkType: OpenShiftSDN
  clusterNetwork:
  - cidr: 10.128.0.0/14
    hostPrefix: 23
  machineNetwork:
  - cidr: 10.0.0.0/16
  serviceNetwork:
  - 172.30.0.0/16
platform:
  azure:
    baseDomainResourceGroupName: openenv-c8nrc
    cloudName: AzurePublicCloud
    region: centralus
pullSecret: "" # skip, hive will inject based on it's secrets
sshKey: |-
    ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDQs/C4/Eer2Cfvr48EuQPhrnF03XCczgYr9UuFOWaCwY7fdCO6qUbje1lJm1C2wPbNaJJH0aBky0gYhHHqxOZjy/S7oTkWlQgv/9S+mTm68YSRnlI5I2WWDVF4hmv80HA1/djsLUl5TDODn5R3b+DN3J3AOMLOmgmbVzYPGiu0WNCbisVduNObHlo7GryAAKDJGZ+5jYLBCzdJ0gPH+UY7Ios5TKJf6Yp8HpltcYyAxw1GfEc2iBcK4PgfQ/lgk1TSs6qEXFTdUwSLVrG6jCnD8r/3jMWqtqPH5MMNQMEGQsU2JZ4NwtP2WgOr9Fom43AIfB8OXD20WOAfsAUrrskv

---
apiVersion: v1
kind: Secret
metadata:
  name: judd-demo-1-ssh-private-key
  namespace: 'judd-demo-1'
stringData:
  ssh-privatekey: # injected on create
type: Opaque
---
apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: judd-demo-1-azure-creds
  namespace: 'judd-demo-1'
stringData:
  osServicePrincipal.json: # injected on create
---
apiVersion: agent.open-cluster-management.io/v1
kind: KlusterletAddonConfig
metadata:
  name: 'judd-demo-1'
  namespace: 'judd-demo-1'
spec:
  clusterName: 'judd-demo-1'
  clusterNamespace: 'judd-demo-1'
  clusterLabels:
    cloud: Azure
    vendor: OpenShift
  applicationManager:
    enabled: true
  policyController:
    enabled: true
  searchCollector:
    enabled: true
  certPolicyController:
    enabled: true
  iamPolicyController:
    enabled: true
apiVersion: v1
kind: Namespace
metadata:
  annotations:
    openshift.io/description: ""
    openshift.io/display-name: {{ cluster_name }}
    openshift.io/requester: {{ ocp_username }}
  name: {{ cluster_name }}
