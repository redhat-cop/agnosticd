# re-use this in pre-workload and destroy-workload

- name: Create temp file for Jumphost private key
  ansible.builtin.tempfile:
    state: file
    suffix: temp
  register: __jumphost_tempfile

- name: Create private key for VMware jumphost
  ansible.builtin.copy:
    dest: "{{ __jumphost_tempfile.path }}"
    content: "{{ vmware_ibm_ldap_jumphost_privatekey }}"
    mode: "0600"

- name: Add ldap jumphost host to the temporary inventory
  ansible.builtin.add_host:
    groupname: network
    name: jumphostldap
    bastion: ""
    isolated: true
    ansible_ssh_host: "{{ vmware_ibm_ldap_jumphost }}"
    ansible_ssh_user: "{{ vmware_ibm_ldap_jumphost_user }}"
    ansible_ssh_private_key_file: "{{ __jumphost_tempfile.path }}"
    private_ip_address: "{{ vmware_ibm_ldap_jumphost }}"
    public_ip_address: "{{ vmware_ibm_ldap_jumphost }}"
