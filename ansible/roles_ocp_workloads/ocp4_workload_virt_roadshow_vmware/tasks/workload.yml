---

# - name: Create webapp VMs
#   ansible.builtin.include_tasks: vcenter-setup-webapp-vms.yml

- name: Create user in AD and assign permissions on vSphere
  ansible.builtin.include_tasks: vcenter-setup-user.yml

- name: If desired, add vddk support to MTV
  when: ocp4_workload_virt_roadshow_enable_mtv | default(true) | bool
  ansible.builtin.include_tasks: vcenter-setup-vddk.yml

- name: Set agnosticd user info data for IBM VMware
  agnosticd_user_info:
    data:
      preinstall_operators: "{{ preinstall_operators }}"
      vcenter_user: "{{ hostvars['localhost']['vcenter_student_username'] }}@{{ vcenter_domain }}"
      vcenter_password: "{{ hostvars['localhost']['vcenter_student_password'] }}"
      vcenter_console: "{{ hostvars['localhost']['vcenter_hostname'] }}"
      vcenter_datastore: "{{ hostvars['localhost']['vcenter_datastore'] }}"
      guid: "{{ guid }}"


# Leave this as the last task in the playbook.
# --------------------------------------------
- name: workload tasks complete
  debug:
    msg: "Workload Tasks completed successfully."
  when: not silent|bool
