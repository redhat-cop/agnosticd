---
- name: Create and expose VMs
  kubernetes.core.k8s:
    state: present
    definition: "{{ lookup('template', resource | from_yaml) }}"
  loop:
  - namespace.yaml.j2
  - rolebinding.yaml.j2
  - vm_database.yaml.j2
  - vm_winweb01.yaml.j2
  - vm_winweb02.yaml.j2
  - service_database.yaml.j2
  - service_webapp.yaml.j2
  - route_webapp.yaml.j2
  loop_control:
    loop_var: resource
