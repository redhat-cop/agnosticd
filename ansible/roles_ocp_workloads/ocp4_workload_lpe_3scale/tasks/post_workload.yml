---

# Implement your Post Workload deployment tasks here
# Implement your Post Workload deployment tasks here
- name: output workshop info
  debug:
    msg: "{{ item }}"
  loop:
    - "user.info: "
    - "user.info: 3scale Multitenant API Manager - details"
    - "user.info: "
    - "user.info: OpenShift Console: https://console-openshift-console.{{ ocp4_workload_lpe_3scale_ocp_apps_domain }}"
    - "user.info: "
    - "user.info: 3scale MASTER Console : https://master.{{ ocp4_workload_lpe_3scale_ocp_apps_domain }}"
    - "user.info: Master login with credentials master / {{ ocp4_workload_lpe_3scale_master_password }} "
    - "user.info: "
    - "user.info: 3scale PROVIDER Admin Console : https://3scale-admin.{{ ocp4_workload_lpe_3scale_ocp_apps_domain }}"
    - "user.info: Master login with credentials admin / {{ ocp4_workload_lpe_3scale_admin_password }} "
    - "user.info: "
    - "user.info: 3scale MASTER API Host : {{ ocp4_workload_lpe_3scale_master_api_host }}"
    - "user.info: "
    - "user.info: 3scale MASTER Create Tenant URL : {{ ocp4_workload_lpe_3scale_create_tenant_url }}"
    - "user.info: "
  when: not silent|bool

- name: Notify requestor of route.  CloudForms will see this and send email
  agnosticd_user_info:
    msg: "{{ item }}"
  loop:
    - "user.info: "
    - "user.info: 3scale Multitenant API Manager - details"
    - "user.info: "
    - "user.info: OpenShift Console: https://console-openshift-console.{{ ocp4_workload_lpe_3scale_ocp_apps_domain }}"
    - "user.info: "
    - "user.info: 3scale MASTER Console : https://master.{{ ocp4_workload_lpe_3scale_ocp_apps_domain }}"
    - "user.info: Master login with credentials master / {{ ocp4_workload_lpe_3scale_master_password }} "
    - "user.info: "
    - "user.info: 3scale PROVIDER Admin Console : https://3scale-admin.{{ ocp4_workload_lpe_3scale_ocp_apps_domain }}"
    - "user.info: Master login with credentials admin / {{ ocp4_workload_lpe_3scale_admin_password }} "
    - "user.info: "
    - "user.info: 3scale MASTER API Host : {{ ocp4_workload_lpe_3scale_master_api_host }}"
    - "user.info: "
    - "user.info: 3scale MASTER Create Tenant URL : {{ ocp4_workload_lpe_3scale_create_tenant_url }}"
    - "user.info: "

- name: Give {{ocp_username}} access to {{ ocp4_workload_lpe_3scale_namespace }}
  shell: "oc policy add-role-to-user admin {{ocp_username}} -n {{ ocp4_workload_lpe_3scale_namespace }}"

- name: Give {{ocp_username}} access to {{ ocp4_workload_lpe_3scale_minio_namespace }}
  shell: "oc policy add-role-to-user admin {{ocp_username}} -n {{ ocp4_workload_lpe_3scale_minio_namespace }}"

- block:
  - name: "Tenant prep"
    include_tasks: 
      file: ./files/3scale_single_tenant_user.yml
  when: ocp4_workload_lpe_3scale_create_tenant|bool
  
# this as the last task in the playbook.

- name: post_workload tasks complete
  debug:
    msg: "Post-Workload Tasks completed successfully."
  when: not silent|bool  

