- name: Is helm even here
  block:

  - name: Is helm present
    ansible.builtin.command:
      cmd: helm version
    register: result

  rescue:

  - name: Install helm
    ansible.builtin.shell: |
      curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
      chmod 700 get_helm.sh
      ./get_helm.sh

  - name: Wait until helm is in path
    ansible.builtin.wait_for:
      path: /usr/local/bin/helm
