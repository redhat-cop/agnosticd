# --------------------------------------------------------
# Deploy Module Guides and User Distribution for Dev Track
# --------------------------------------------------------
- name: Create prerequisites for guides
  kubernetes.core.k8s:
    state: present
    definition: "{{ lookup('template', item ) | from_yaml }}"
  loop:
  - guides/namespace.yaml.j2
  - guides/imagestream_httpd.yaml.j2

- name: Create module list
  ansible.builtin.set_fact:
    _ocp4_workload_acc_new_app_dev_guides_modules_list: "{{ ocp4_workload_acc_new_app_dev_guides_modules.split(';') | map('trim') | list }}"

- name: Print selected modules
  debug:
    msg: "Selected list of modules: {{ _ocp4_workload_acc_new_app_dev_guides_modules_list }}"

- name: Deploy guides
  vars:
    _ocp4_workload_acc_new_app_dev_guide: "{{ ocp4_workload_acc_new_app_dev_guides_repo_prefix }}-{{ module }}"
  ansible.builtin.include_tasks: guides_modules_install.yml
  loop: "{{ _ocp4_workload_acc_new_app_dev_guides_modules_list }}"
  loop_control:
    loop_var: module

# - name: Install username distribution tool
#   include_tasks: dev-username-distribution-install.yml

# _ocp4_workload_acc_new_app_dev_console_url