apiVersion: tekton.dev/v1beta1
kind: PipelineRun
metadata:
  name: app-globex-ui-pipeline-{{ 99999999 | random | to_uuid }}
  namespace: {{ ocp4_workload_devsecops_validated_pattern_ci_namespace }}
spec:
  params:
    - name: REPO_HOST
      value: {{ _ocp4_workload_devsecops_validated_pattern_gitea_hostname }}
    - name: GIT_REPO
      value: >-
        {{ _ocp4_workload_devsecops_validated_pattern_gitea_repo_globex_ui_url }}
    - name: TLSVERIFY
      value: 'true'
    - name: BUILD_EXTRA_ARGS
      value: $(tt.params.build_extra_args)
    - name: IMAGE_REPO
      value: >-
        {{ ocp4_workload_devsecops_validated_pattern_docker_registry }}/{{
        ocp4_workload_devsecops_validated_pattern_docker_username }}/globex-ui
    - name: IMAGE_TAG
      value: main-{{ _ocp4_workload_devsecops_validated_pattern_pipline_uid }}
    - name: MANIFEST_FILE
      value: gitops/globex/overlays/dev/kustomization.yaml
    - name: MANIFEST_FILE_PROD
      value: gitops/globex/overlays/prod/kustomization.yaml
    - name: MANIFEST_REPO
      value: >-
        {{ _ocp4_workload_devsecops_validated_pattern_gitea_repo_devsecops_url }}
    - name: MANIFEST_REPO_NAME
      value: dev-user/devsecops-validated-pattern
    - name: COMMIT_SHA
      value: {{ _ocp4_workload_devsecops_validated_pattern_pipline_uid }}
    - name: GIT_REF
      value: main
    - name: COMMIT_DATE
      value: '2023-01-17T12:56:58Z'
    - name: COMMIT_AUTHOR
      value: dev-user
    - name: COMMIT_MESSAGE
      value: |
        Update 'README.md'
    - name: SONARQUBE_HOST_URL
      value: >-
        {{ _ocp4_workload_devsecops_validated_pattern_sonarqube_host_url }}
    - name: SONARQUBE_PROJECT_KEY
      value: globex-ui
    - name: SONARQUBE_PROJECT_SECRET
      value: globex-ui-sonarqube-secret
  pipelineRef:
    name: app-globex-ui-pipeline
  serviceAccountName: pipeline
  timeout: 1h0m0s
  workspaces:
    - name: shared-data
      volumeClaimTemplate:
        metadata:
          creationTimestamp: null
        spec:
          accessModes:
            - ReadWriteOnce
          resources:
            requests:
              storage: 1Gi
        status: {}
    - emptyDir: {}
      name: maven-settings
    - emptyDir: {}
      name: signature