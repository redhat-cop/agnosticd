---
- name: Set passthrough variables into per-user data, if desired
  when:
  - agnosticd_passthrough_user_data is defined
  - ocp4_workload_gitops_bootstrap_passthrough_user_data is true | default(false) | bool
  agnosticd_user_info:
    data: "{{ agnosticd_passthrough_user_data | default('', true) }}"
    user: "user{{ n }}"
  loop: "{{ range(1, num_users | int + 1) | list }}"
  loop_control:
    loop_var: n

- name: Combine with all user_data
  ansible.builtin.set_fact:
    _ocp4_workload_gitops_bootstrap_deployer_values: |
     {{ _ocp4_workload_gitops_bootstrap_deployer_values |
        combine( _gitops_user_lookup('agnosticd_user_data', '*') )}}"
