---
# Implement your Post Workload deployment tasks here
# --------------------------------------------------

- name: Print no SSH
  debug:
    msg: "user.info: {{ item }}"
  with_items:
    - ""
    - '***********************************************************'
    - 'IMPORTANT: You cannot SSH into the shared cluster.'
    - 'Please refer to the demo or lab instructions in order'
    - 'to get the steps on how to access the environment properly.'
    - '***********************************************************'
    - ""

- name: Get Web Console URL
  command: oc whoami --show-console
  register: r_routeconsole
  ignore_errors: yes

- name: Print Web Console URL
  when: r_routeconsole is succeeded
  debug:
    msg: "{{ item }}"
  with_items:
  - "user.info: Openshift Web Console: {{ r_routeconsole.stdout | trim }}"

- name: Get API URL
  command: oc whoami --show-server
  register: r_showserver
  ignore_errors: yes

- name: Print API URL
  when: r_showserver is succeeded
  debug:
    msg: "user.info: {{ item }}"
  with_items:
  - "Openshift API for command line 'oc' client: {{ r_showserver.stdout | trim }}"

# Leave these as the last tasks in the playbook
# ---------------------------------------------

# For deployment onto a dedicated cluster (as part of the
# cluster deployment) set workload_shared_deployment to False
# This is the default so it does not have to be set explicitely
- name: post_workload tasks complete
  debug:
    msg: "Post-Workload tasks completed successfully."
  when:
  - not silent|bool
  - not workload_shared_deployment|default(False)

# For RHPDS deployment (onto a shared cluster) set
# workload_shared_deployment to True
# (in the deploy script or AgnosticV configuration)
- name: post_workload tasks complete
  debug:
    msg: "Post-Software checks completed successfully"
  when:
  - not silent|bool
  - workload_shared_deployment|default(False)