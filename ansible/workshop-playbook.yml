- hosts: localhost
  name: Install Workshop
  vars:
    bookbag_git_repo: https://github.com/GuilhermeCamposo/bookbag-template.git
    ocp4_workload_authentication_htpasswd_user_count: 2
    ocp4_workload_authentication_htpasswd_user_base: user
    ocp4_workload_authentication_htpasswd_user_password: openshift
    guid: test
    ACTION: 'create'
  tasks:

    - name: Set output_dir
      ansible.builtin.set_fact:
        output_dir: '/tmp/ansible'

    - name: Delete output_dir
      ansible.builtin.file:
        path: "{{ output_dir }}"
        state: absent

    - name: Create output_dir
      ansible.builtin.file:
        path: "{{ output_dir }}"
        state: directory
        mode: '0755'

    - name: Create empty user-info.yaml and user-data.yaml in output dir
      ansible.builtin.copy:
        content: |
          ---
        dest: "{{ output_dir }}/{{ item }}"
      loop:
        - user-info.yaml
        - user-data.yaml

    - name: Include Performance Monitoring Workshop role
      ansible.builtin.include_role:
        name: roles_ocp_workloads/ocp4_workload_performance_monitoring

    # - name: Include Bookbag role
    #   ansible.builtin.include_role:
    #     name: roles/bookbag
